/*second order differential equation */
#include <stdio.h>

#define _USE_MATH_DEFINES
#include <math.h>

#define N 40
float f(float x,float y,float y1)
{ return -y; }
int main(void){
    int i,n;
    float h,x[N+1],y[N+1],y1[N+1],y2[N+1],r;
    h=0.2;
    x[0]=0.0;
    y[0]=2.0;
    y1[0]=2.0;
    i=0;
    printf(" x , y ( error )\n");
    do {
        y2[i]=f(x[i],y[i],y1[i]);
        x[i+1]=x[i]+h;
        y1[i+1]=y1[i]+h*y2[i];
        y[i+1]=y[i]+h*y1[i]+h*h*y2[i]/2.0;
        i++;
        r=-2*sqrt(2)*sin(x[i]-M_PI/4);
        printf("%8.5f,%8.5f (%8.5f)\n",
        x[i],y[i],r-y[i]);
    } while(x[i]<4.0&&i<N);
}

/*
 x , y ( error )
 0.20000, 2.36000 (-0.79721)
 0.40000, 2.63280 (-1.56951)
 0.60000, 2.80574 (-2.28436)
 0.80000, 2.86992 (-2.91122)
 1.00000, 2.82058 (-3.42291)
 1.20000, 2.65743 (-3.79679)
 1.40000, 2.38472 (-4.01568)
 1.60000, 2.01116 (-4.06871)
 1.80000, 1.54969 (-3.95179)
 2.00000, 1.01701 (-3.66789)
 2.20000, 0.43298 (-3.22698)
 2.40000,-0.18004 (-2.64568)
 2.60000,-0.79812 (-1.94666)
 2.80000,-1.39664 (-1.15779)
 3.00000,-1.95126 (-0.31097)
 3.20000,-2.43892 ( 0.55908)
 3.40000,-2.83878 ( 1.41627)
 3.60000,-3.13309 ( 2.22461)
 3.80000,-3.30796 ( 2.94974)
 4.00000,-3.35401 ( 3.56033)
*/